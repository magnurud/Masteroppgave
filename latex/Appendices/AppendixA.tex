% Appendix A

\chapter{Properties of Legendre polynomials} % Main appendix title

\label{AppendixA} % For referencing this appendix elsewhere, use \ref{AppendixA}

\lhead{Appendix A. \emph{Numerical analysis}} % This is for the header on each page - perhaps a shortened title

The Legendre polynomials are a group of orthogonal polynomials on $(-1,1)$ satisfying the recurrence relation 
\begin{align}
    (n+1)L_{n+1}(x) = (2n+1)xL_{n}(x)-nL_{n-1}(x),
    \label{eq:Legendrerecursive}
\end{align}
where $L_0(x) = 1$ and $L_1(x) = x$. Some other useful properties are the $L_2$-norm and 
the derivatives which can be found in any texbook, for instance~\cite{Canuto},
\begin{align}
    \begin{split}
    ||L_n(x)||^2 &= \int_{-1}^1L_{n}(x)dx = \frac{2}{2n+1},  \\
    L_{n+1}'(x) &= (2n+1)L_n(x)+L_{n-1}'(x).
    \end{split}
    \label{eq:relations}
\end{align}
By continuing the recursive form of the second line in \eref{eq:relations} one obtains
\begin{align}
    \begin{split}
    L_{n-1}'(x) &= (2(n-2)+1)L_{n-2}(x)+L_{n-3}'(x), \\
    L_{n-3}'(x) &= (2(n-4)+1)L_{n-4}(x)+L_{n-5}'(x), \\
    \vdots 
    \end{split}
    \label{eq:derivatives}
\end{align}
Which ultimately enables an expression for the derivative based on the lower order Legendre polynomials, explicitly given as 
\begin{align}
    \begin{split}
    L_{n+1}'(x) &= (2n+1)L_n(x)\\
    &+(2(n-2)+1)L_{n-2}(x)\\
    &+(2(n-4)+1)L_{n-4}(x)+\cdots 
    \end{split}
    \label{eq:der-explicit}
\end{align}
Notice that the coefficients in front of each polynomial is 2 times the inverse norm of the same polynomial squared, allowing the expression 
to be simplified to 
\begin{align}
    \begin{split}
    L_{n+1}'(x) &= 2||L_n||^{-2}L_n(x)\\
    &+2||L_{n-2}||^{-2}L_{n-2}(x)\\
    &+2||L_{n-4}||^{-2}L_{n-4}(x)+\cdots 
    \end{split}
    \label{eq:der-explicit1}
\end{align}
In this thesis the second order derivatives will be used and by the result in \eref{eq:der-explicit} they will be given as 
\begin{align}
    \begin{split}
    L_{n+1}''(x) &= 2||L_n||^{-2}L_n'(x)\\
    &+2||L_{n-2}||^{-2}L_{n-2}'(x)\\
    &+2||L_{n-4}||^{-2}L_{n-4}'(x)+\cdots 
    \end{split}
    \label{eq:der-explicit2}
\end{align}
Applying the same recurrence relations from~\eref{eq:der-explicit} to the rhs. derivatives and assembling the terms allows the 
second derivative of the Legendre polynomial to be written as 
\begin{align}
    \begin{split}
        \frac{1}{4}L_{n+1}''(x) &= ||L_n||^{-2}||L_{n-1}||^{-2}L_{n-1}(x)\\
        &+\left( ||L_n||^{-2}+||L_{n-2}||^{-2} \right)||L_{n-3}||^{-2}L_{n-3}(x)\\
        &+\left( ||L_n||^{-2}+||L_{n-2}||^{-2}+||L_{n-4}||^{-2} \right)||L_{n-5}||^{-2}L_{n-5}(x) \cdots
    \end{split}
    \label{eq:laplacian-explicit}
\end{align}
This can be written in a compact form as
\begin{align}
    L_{n+1}''(x) &= \sum_{j=1}^{\lceil n/2 \rceil}\Lambda_{n+1,n+1-2j}L_{n+1-2j}(x),\\
    \Lambda_{n+1,n+1-2j} &= 4||L_{n+1-2j}||^{-2}\sum_{k=0}^{j-1}||L_{n-2k}||^{-2}.
    \label{eq:legendresummation}
\end{align}
The sum $\Lambda_{i,j}$ can be considered as the coefficient describing the amount of $L_i''$ 
which is described by $L_j$. For the sake of clarity $\Lambda$ is restated here with indices $i,j$
\begin{align}
    \Lambda_{i,j} &= 4||L_{j}||^{-2}\sum_{k=0}^{(i-j)/2-1}||L_{i-1-2k}||^{-2}.
    \label{eq:legendresummation}
\end{align}
